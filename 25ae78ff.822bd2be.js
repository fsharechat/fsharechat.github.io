(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{99:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return r})),t.d(e,"metadata",(function(){return s})),t.d(e,"rightToc",(function(){return c})),t.d(e,"default",(function(){return p}));var i=t(2),o=t(6),a=(t(0),t(224)),r={layout:"post",title:"Ubuntu\u4e0a\u5355\u673a\u90e8\u7f72\u5b9e\u8df5",description:"docker IM cloud native",category:"IM"},s={unversionedId:"guide/ubuntu",id:"guide/ubuntu",isDocsHomePage:!1,title:"Ubuntu\u4e0a\u5355\u673a\u90e8\u7f72\u5b9e\u8df5",description:"docker IM cloud native",source:"@site/docs/guide/ubuntu.md",slug:"/guide/ubuntu",permalink:"/docs/guide/ubuntu",version:"current",sidebar:"docs",previous:{title:"Centos\u4e0a\u5355\u673a\u90e8\u7f72\u5b9e\u8df5",permalink:"/docs/guide/centos"},next:{title:"Windows\u5355\u673a\u90e8\u7f72\u5b9e\u8df5",permalink:"/docs/guide/windows"}},c=[{value:"1. apt\u5b89\u88c5",id:"1-apt\u5b89\u88c5",children:[]},{value:"2. \u6587\u4ef6\u4f4d\u7f6e",id:"2-\u6587\u4ef6\u4f4d\u7f6e",children:[]},{value:"3. \u542f\u52a8nginx",id:"3-\u542f\u52a8nginx",children:[]},{value:"4. nginx\u547d\u4ee4",id:"4-nginx\u547d\u4ee4",children:[]},{value:"\u672c\u5730\u5316\u5b89\u88c5",id:"\u672c\u5730\u5316\u5b89\u88c5",children:[]},{value:"base\u811a\u672c\u542f\u52a8\u95ee\u9898",id:"base\u811a\u672c\u542f\u52a8\u95ee\u9898",children:[]},{value:"JKS \u914d\u7f6e",id:"jks-\u914d\u7f6e",children:[]},{value:"\u6570\u636e\u5e93\u95ee\u9898",id:"\u6570\u636e\u5e93\u95ee\u9898",children:[{value:"\u6570\u636e\u5e93\u94fe\u63a5serverzone\u95ee\u9898",id:"\u6570\u636e\u5e93\u94fe\u63a5serverzone\u95ee\u9898",children:[]},{value:"\u6570\u636e\u5e93\u7248\u672c\u95ee\u9898",id:"\u6570\u636e\u5e93\u7248\u672c\u95ee\u9898",children:[]}]}],l={rightToc:c};function p(n){var e=n.components,t=Object(o.a)(n,["components"]);return Object(a.b)("wrapper",Object(i.a)({},l,t,{components:e,mdxType:"MDXLayout"}),Object(a.b)("p",null,"\u6b64\u6587\u6863\u4e3b\u8981\u8bf4\u660e\u5728ubuntu\u5355\u51fb\u90e8\u7f72\u98de\u4eab\u7684\u57fa\u672c\u6b65\u9aa4\u4e0e\u6ce8\u610f\u4e8b\u9879,\u91cd\u70b9\u8bf4\u660e\u53ef\u80fd\u51fa\u9519\u7684\u5730\u65b9\u4e0e\u89e3\u51b3\u65b9\u6848"),Object(a.b)("h1",{id:"nginx-\u5b89\u88c5"},"Nginx \u5b89\u88c5"),Object(a.b)("h2",{id:"1-apt\u5b89\u88c5"},"1. apt\u5b89\u88c5"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell"}),"sudo apt install nginx\n")),Object(a.b)("h2",{id:"2-\u6587\u4ef6\u4f4d\u7f6e"},"2. \u6587\u4ef6\u4f4d\u7f6e"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell"}),"/usr/sbin/nginx    :\u4e3b\u7a0b\u5e8f\n/etc/nginx         :\u914d\u7f6e\u6587\u4ef6\n/usr/share/nginx   :\u5b58\u653e\u9759\u6001\u6587\u4ef6\n/var/log/nginx     :\u5b58\u653e\u65e5\u5fd7\n")),Object(a.b)("h2",{id:"3-\u542f\u52a8nginx"},"3. \u542f\u52a8nginx"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell"}),"service nginx start # \u542f\u52a8nginx\nservice nginx reload # \u91cd\u65b0\u52a0\u8f7dnginx\u914d\u7f6e\u6587\u4ef6\n")),Object(a.b)("h2",{id:"4-nginx\u547d\u4ee4"},"4. nginx\u547d\u4ee4"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell"}),"nginx -s reopen # \u91cd\u542fnginx\nnginx -s stop # \u505c\u6b62nginx\nnginx -v # \u67e5\u770b\u7248\u672c\u53f7\n")),Object(a.b)("h1",{id:"minio\u5b89\u88c5"},"Minio\u5b89\u88c5"),Object(a.b)("h2",{id:"\u672c\u5730\u5316\u5b89\u88c5"},"\u672c\u5730\u5316\u5b89\u88c5"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{}),'wget http://dl.minio.org.cn/server/minio/release/linux-amd64/minio\nchmod +x minio\n## \u524d\u53f0\u542f\u52a8\n./minio server data/\n## \u540e\u53f0\u542f\u52a8\nnohup ./minio server miniodata/ >/data/minio.log 2>&1 &\n## \u4fee\u6539\u53c2\u6570\u542f\u52a8 \u76ee\u524d\u4e0d\u542f\u7528https,\u6240\u6709\u7684\u90fd\u7ecf\u8fc7nginx\u8f6c\u53d1\nMINIO_ACCESS_KEY=test MINIO_SECRET_KEY=test123456 nohup ./minio  server  miniodata/  > /opt/minio/minio.log 2>&1 &\n## \u542f\u52a8https \u6ce8\u610faccesskey \u548csecretkey \u4fdd\u6301\u4e0d\u53d8\nMINIO_ACCESS_KEY=test MINIO_SECRET_KEY=test nohup ./minio  server --address ":443" /data/miniodata/  > /data/minio.log 2>&1 &\n')),Object(a.b)("h1",{id:"im-\u670d\u52a1\u5b89\u88c5"},"IM \u670d\u52a1\u5b89\u88c5"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"NOTE:")," \u53c2\u89c1",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/fsharechat/chat-server-release"}),"\u670d\u52a1\u5b89\u88c5\u8bf4\u660e")),Object(a.b)("h2",{id:"base\u811a\u672c\u542f\u52a8\u95ee\u9898"},"base\u811a\u672c\u542f\u52a8\u95ee\u9898"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"NOTE:")," \u6ce8\u610f\u4fee\u6539\u58f0\u660e",Object(a.b)("inlineCode",{parentName:"p"},"#!/bin/sh")),Object(a.b)("h2",{id:"jks-\u914d\u7f6e"},"JKS \u914d\u7f6e"),Object(a.b)("h2",{id:"\u6570\u636e\u5e93\u95ee\u9898"},"\u6570\u636e\u5e93\u95ee\u9898"),Object(a.b)("h3",{id:"\u6570\u636e\u5e93\u94fe\u63a5serverzone\u95ee\u9898"},"\u6570\u636e\u5e93\u94fe\u63a5serverzone\u95ee\u9898"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-yaml"}),"set global time_zone='+8:00';\n")),Object(a.b)("h3",{id:"\u6570\u636e\u5e93\u7248\u672c\u95ee\u9898"},"\u6570\u636e\u5e93\u7248\u672c\u95ee\u9898"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-java"}),"SQL State  : 42000\nError Code : 1067\nMessage    : Invalid default value for '_dt'\nLocation   : migrate/mysql/V2__create_table.sql (/data/boot/push-group/file:/data/boot/push-group/lib/spring-boot-web-push-group-1.2.1.jar!/BOOT-INF/classes!/migrate/mysql/V2__create_table.sql)\nLine       : 21\n\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"NOTE:")," \u9700\u89815.6.5\u4e4b\u540e\u7248\u672c\u624d\u652f\u6301"),Object(a.b)("h1",{id:"nginx-\u670d\u52a1\u914d\u7f6e"},"Nginx \u670d\u52a1\u914d\u7f6e"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-properties"}),'user www-data;\nworker_processes auto;\npid /run/nginx.pid;\ninclude /etc/nginx/modules-enabled/*.conf;\n\nevents {\n  worker_connections 768;\n  # multi_accept on;\n}\n\nhttp {\n\n  upstream blog  {\n      server 129.227.138.58:4000;\n  }\n\n  server {\n      listen 80;\n      server_name comsince.cn  www.comsince.cn;\n      #rewrite ^ https://$host$request_uri? permanent;\n      #rewrite ^(.*)$ https://$host$1 permanent;\n      if ($scheme != "https") {\n          return 301 https://$host$request_uri;\n      }            \n\n      if ($host = www.comsince.cn) {\n         return 301 https://$host$request_uri;\n      }\n\n      if ($host = comsince.cn) {\n         return 301 https://$host$request_uri;\n      }\n\n      if ($host = media.comsince.cn) {\n         return 301 https://$host$request_uri;\n      }\n\n      #return 404;\n      root   html;\n      index  index.html index.htm index.php;\n      \n  }\n\n  server {\n        listen       443 ssl;\n        server_name  localhost;\n\n        ssl_certificate      /etc/letsencrypt/live/comsince.cn/fullchain.pem;\n        ssl_certificate_key  /etc/letsencrypt/live/comsince.cn/privkey.pem;\n\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n\n        location /web {\n               root   /data/boot/;\n               index  index.html index.htm;\n        }\n\n        location /mobile {\n               root   /data/boot/;\n               index  index.html index.htm;\n        }\n  \n\n        location /minio {\n            proxy_pass  http://localhost:9000;\n        }\n\n        location /login {\n            proxy_pass http://localhost:8081;\n        }\n        \n        location /send_code {\n            proxy_pass http://localhost:8081;\n        }\n\n\n        location ~* /minio-bucket* {\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n          proxy_set_header Host $http_host;\n          client_max_body_size  500m;\n          proxy_connect_timeout 300;\n          # Default is HTTP/1, keepalive is only enabled in HTTP/1.1\n          proxy_http_version 1.1;\n          proxy_set_header Connection "";\n          chunked_transfer_encoding off;\n          proxy_pass  http://localhost:9000;\n        }\n\n    }\n\n  ##\n  # Basic Settings\n  ##\n\n  sendfile on;\n  tcp_nopush on;\n  tcp_nodelay on;\n  keepalive_timeout 65;\n  types_hash_max_size 2048;\n  # server_tokens off;\n\n  # server_names_hash_bucket_size 64;\n  # server_name_in_redirect off;\n\n  include /etc/nginx/mime.types;\n  default_type application/octet-stream;\n\n  ##\n  # SSL Settings\n  ##\n\n  ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE\n  ssl_prefer_server_ciphers on;\n\n  ##\n  # Logging Settings\n  ##\n\n  access_log /var/log/nginx/access.log;\n  error_log /var/log/nginx/error.log;\n\n  ##\n  # Gzip Settings\n  ##\n\n  gzip on;\n\n  # gzip_vary on;\n  # gzip_proxied any;\n  # gzip_comp_level 6;\n  # gzip_buffers 16 8k;\n  # gzip_http_version 1.1;\n  # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;\n\n  ##\n  # Virtual Host Configs\n  ##\n\n  include /etc/nginx/conf.d/*.conf;\n  include /etc/nginx/sites-enabled/*;\n}\n\n\n#mail {\n# # See sample authentication script at:\n# # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript\n# \n# # auth_http localhost/auth.php;\n# # pop3_capabilities "TOP" "USER";\n# # imap_capabilities "IMAP4rev1" "UIDPLUS";\n# \n# server {\n#   listen     localhost:110;\n#   protocol   pop3;\n#   proxy      on;\n# }\n# \n# server {\n#   listen     localhost:143;\n#   protocol   imap;\n#   proxy      on;\n# }\n#}\n\n')))}p.isMDXComponent=!0}}]);